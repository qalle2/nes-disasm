clear
rm -f test-out/*.asm test-out/*.bin

# Note: opcodes:
# 01 = ORA (indirect,x), 41 = EOR (indirect,x), c1 = CMP (indirect,x), e1 = SBC (indirect,x)

echo "=== Lunar Pool (use CDL file; disassemble unaccessed bytes) ==="
python3 nesdisasm.py --no-absolute-zp --no-absolute-indexed-zp --no-opcodes 00,01,41,c1,e1 --no-access 0800-1fff,2008-3fff,4020-bfff --no-execute 2000-401f --no-write 8000-ffff --cdl-file ~/nes/cdl/lunarpool-u.cdl test-in/lunarpool.prg > test-out/lunarpool.asm
asm6f test-out/lunarpool.asm test-out/lunarpool-reassembled.bin
diff test-in/lunarpool.prg test-out/lunarpool-reassembled.bin
echo

echo "=== Lunar Pool (use CDL file; don't disassemble unaccessed bytes) ==="
python3 nesdisasm.py --no-absolute-zp --no-absolute-indexed-zp --no-opcodes 00,01,41,c1,e1 --no-access 0800-1fff,2008-3fff,4020-bfff --no-execute 2000-401f --no-write 8000-ffff --cdl-file ~/nes/cdl/lunarpool-u.cdl --unaccessed-as-data test-in/lunarpool.prg > test-out/lunarpool-nounacc.asm
asm6f test-out/lunarpool-nounacc.asm test-out/lunarpool-nounacc-reassembled.bin
diff test-in/lunarpool.prg test-out/lunarpool-nounacc-reassembled.bin
echo

echo "=== Lunar Pool (don't use CDL file) ==="
python3 nesdisasm.py --no-absolute-zp --no-absolute-indexed-zp --no-opcodes 00,01,41,c1,e1 --no-access 0800-1fff,2008-3fff,4020-bfff --no-execute 2000-401f --no-write 8000-ffff test-in/lunarpool.prg > test-out/lunarpool-nocdl.asm
asm6f test-out/lunarpool-nocdl.asm test-out/lunarpool-nocdl-reassembled.bin
diff test-in/lunarpool.prg test-out/lunarpool-nocdl-reassembled.bin
echo

